<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; Charset=utf-8">
<meta http-equiv="Content-Language" content="zh-CN">
<meta name="viewport"
	content="width=device-width, initial-scale=1, user-scalable=no" />
<title>梦境迷离 - 关于本站</title>
<link rel="shortcut icon" th:href="@{/images/Logo_40.png}"
	type="image/x-icon">
<!--Layui-->
<link th:href="@{/layui/css/layui.css}" rel="stylesheet" />
<!--font-awesome-->
<link th:href="@{/plug/font-awesome/css/font-awesome.min.css}"
	rel="stylesheet" />
<!--全局样式表-->
<link th:href="@{/css/global.css}" rel="stylesheet" />
<!-- 本页样式表 -->
<link th:href="@{/css/about.css}" rel="stylesheet" />
</head>
<body>
	<!-- 导航 -->
	<nav class="blog-nav layui-header" >
	<div class="blog-container">
	<!-- QQ互联登陆 -->
<!-- 	<a target="_blank" th:href="@{/login}" class="blog-user"><span
		style="color: white;text-align: right;font-size: 15px;"> <i
			class="layui-icon" style="font-size: 15px;">&#xe614;</i>
	</span> </a> -->
	<!--  <a href="javascript:;" class="blog-user layui-hide"> <img
				th:src="@{/images/Absolutely.jpg}" alt="jxnu-liguobin"
				title="jxnu-liguobin" />
			</a>  -->
	<a class="blog-logo" th:href="@{/index/home.html}">梦境迷离</a>
	<!-- 导航菜单 -->
	<ul class="layui-nav" lay-filter="nav">
		<li class="layui-nav-item"><a th:href="@{/index/home.html}"><i
				class="fa fa-home fa-fw"></i>&nbsp;网站首页</a></li>
		<li class="layui-nav-item"><a th:href="@{/index/article.html}"><i
				class="fa fa-file-text fa-fw"></i>&nbsp;文章专栏</a></li>
		<li class="layui-nav-item"><a
			th:href="@{/indexViews/resource.html}"><i
				class="fa fa-tags fa-fw"></i>&nbsp;资源分享</a></li>
		<li class="layui-nav-item"><a
			th:href="@{/indexViews/timeline.html}"><i
				class="fa fa-hourglass-half fa-fw"></i>&nbsp;点点滴滴</a></li>
		<li class="layui-nav-item layui-this"><a
			th:href="@{/index/about.html}"><i class="fa fa-info fa-fw"></i>&nbsp;关于本站</a>
		</li>
	</ul>
	<!-- 手机和平板的导航开关 -->
	<a class="blog-navicon" href="javascript:;"> <i
		class="fa fa-navicon"></i>
	</a>
</div>
	</nav>
	<!-- 主体（一般只改变这里的内容） -->
	<div class="blog-body">
		<div class="blog-container">
			<blockquote class="layui-elem-quote sitemap layui-breadcrumb shadow">
				<cite> <a th:href="@{/index/home.html}" title="网站首页">网站首页 </a></cite> <cite>
					<a>关于本站</a>
				</cite>
			</blockquote>
			<div class="blog-main">
				<div class="layui-tab layui-tab-brief shadow" lay-filter="tabAbout">
					<ul class="layui-tab-title">
						<li lay-id="1">关于博客</li>
						<li lay-id="2">关于作者</li>
						<li lay-id="3">留言墙</li>
					</ul>
					<div class="layui-tab-content">
						<div class="layui-tab-item">
							<div class="aboutinfo">
								<div class="aboutinfo-figure">
									<img style="width: 100px;height: 100px;" th:src="@{/images/Logo_100.png}" alt="jxnu-liguobin" />
								</div>
								<p class="aboutinfo-nickname">梦境迷离</p>
								<p class="aboutinfo-introduce">爱Java，爱生活。</p>
								<p class="aboutinfo-location">
									<i class="fa fa-link"></i>&nbsp;&nbsp;<a id="website" target="_blank"
										href="https://www.dreamylost.cn">www.dreamylost.cn[梦幻迷离]</a>
								</p>
								<hr />
								<div class="aboutinfo-contact">
									<a target="_blank" title="网站首页" th:href="@{/index/home}"><i
										class="fa fa-home fa-2x"
										style="font-size:2.5em;position:relative;top:3px"></i></a> <a
										target="_blank" title="文章专栏" th:href="@{/index/article}"><i
										class="fa fa-file-text fa-2x"></i></a> <a target="_blank"
										title="资源分享" th:href="@{/indexViews/resource.html}"><i
										class="fa fa-tags fa-2x"></i></a> <a target="_blank" title="点点滴滴"
										th:href="@{/indexViews/timeline.html}"><i
										class="fa fa-hourglass-half fa-2x"></i></a>
								</div>

								<fieldset class="layui-elem-field">
									<legend>简介</legend>
									<div class="layui-field-box aboutinfo-abstract" style="overflow:hidden;" >
										<p style="text-align:center;">梦境迷离是一个由java开源框架SpringBoot开发的个人博客网站，诞生于2017年12月13日，暂且称为V1.0。</p>
										  <div class="layui-field-box" style="font-family:monospace; ;font-size: 15px;">
											  主要技术<br>
											1、JDK:1.8 (未使用1.8特性)<strong>修改->application-dev.properties, cmd-> java -jar blog.jar 即可运行项目<br>  
											注：本地不要使用java -jar运行最好，需要改为发布的服务器路径而且坑多，使用eclipse运行application.java最好，使用war则需要添加一个转换和修改打包方方式具体百度。
											均需要保证路径C:/web/uploads/存在（tomcat的虚拟路径，已经写死在代码中，默认在服务器与本机创建c:\web）
											在web里新建文件夹filenames,filenames存放静态资源file,则访问方式为ip:port/filenames/file,以此类推，注意Shiro拦截）</strong><br>
											2、前端模板：来自国产开源框架Layui社区的分享“不落阁”，含百度分享等插件<br>
											3、全文检索：Lucene<br>
											4、前端模板引擎：Thymeleaf（nekohtml）<br>
											5、字体：font-awesome<br>
											6、代码高亮：prettify<br>
											7、后台：SpringBoot1.5.8、Mybatis3.4.5、Mysql5.6<br>
											8、验证：jquery-validate、Shiro<br>
											9、日志：默认logback<br>
											10、单元测试：Junit4<br>
											11、数据库连接池：Druid(含sql与spring监控)<br>
											12、JSON工具 ：fastjson<br>
											13、web服务器:Tomcat8.5内嵌式 使用Https<br>
											14、发布方式：Jar<br>
											15、代码托管：github<br>
											16、依赖管理：maven<br>
											17、开发工具：MyEclipse2013<br>
											18、缓存：Myabtis二级缓存（友情链接）,redis缓存（验证码）,ehcache（权限）<br>
											19、评论插件：搜狐畅评
										  <div class="layui-field-box">
										  </div>主要开发进度<br>
											<h4 style="text-align: left;color:blue;">2017年11月13日</h4>
											1、使用Layui+SpringBoot+Myabtis+Mysql+Lucene写的个人博客<br>
											<h4 style="text-align: left;color:blue;">2017年11月13日</h4>
											1、完成前端分页，侧栏显示<br>
											<h4 style="text-align: left;color:blue;">2017年11月14日</h4>
											1、完成详情页面显示跳转和评论<br>
											<h4 style="text-align: left;color:blue;">2017年11月15日</h4>
											1、修复详情页面文章内容图片过大问题<br>
											<h4 style="text-align: left;color:blue;">2017年11月20日</h4>
											1、添加http强制重定向至https的支持<br>
											2、修复百度分享不支持https<br>
											3、修复QQ互联无法打开QQ，群<br>
											<h4 style="text-align: left;color:blue;">2017年11月21日</h4>
											1、添加评论验证码，修复thymeleaf无法正常显示（后台返回json,前台解析，ps:直接显示偶而失效）<br>
											2、bug:无法清空富文本（准备使用自定义函数代替reset【$('#LAY_layedit_1').contents().find('body').html('');】）<br>
											<h4 style="text-align: left;color:blue;">2017年11月22日</h4>
											1、添加文章关键字侧栏<br>
											2、修复写文章和修改文章不能清空富文本bug<br>
											<h4 style="text-align: left;color:blue;">2017年11月28日</h4>
											1、修复未审核的评论也被计算在内<br>
											2、IdentityHashMap造成的乱序问题（覆盖TreeMap的CompareTo方法）未修复<br>
											3、搜索下方显示最近搜索（cookies）未完成<br>
											<h4 style="text-align: left;color:blue;">2017年11月29日</h4>
											1、添加代码高亮显示（bug:如果是直接复制的图片，大小无法控制，图片宽度超过屏幕）<br>
											2、添加lucene全文检索，关键字高亮（bug:摘要 博客类型构建索引失败--解决）<br>
											<h4 style="text-align: left;color:blue;">2017年12月1日</h4>
											1、添加代码高亮显示（显示行数，有bug）<br>
											2、完善lucene全文检索<br>
											3、添加搜索排行，显示前20条最高搜索次数的关键词<br>
											<h4 style="text-align: left;color:blue;">2017年12月4日</h4>
											1、添加前台ip拦截，禁止访问与倒计时<br>
											2、完善开发文档<br>
											3、修复IdentityHashMap造成的乱序问题（与此同时，同key的value仍无法解决）<br>
											<h4 style="text-align: left;color:blue;">2017年12月5日</h4>
											1、添加留言以及其他小修改<br>
											<h4 style="text-align: left;color:blue;">2017年12月6日</h4>
											1、开启事务支持<br>
											2、修复ip解析地址时超时，添加数据库字段address存储地址<br>
											<h4 style="text-align: left;color:blue;">2017年12月9日</h4>
											添加403 404 405 406 500等页面的处理 <br>
											1、404 405特殊处理->实现ErrorController接口<br>
											2、500->实现容器的customize方法<br>
											3、403使用Shiro session 406使用拦截器<br>
											添加公告功能，完成公告dao以及service层接口与测试<br>
											<h4 style="text-align: left;color:blue;">2017年12月10日</h4>
											1、修正手机Ipad的悬浮窗显示不正确<br>
											2、头像上传改为缩略图显示，前台文章和个人信息也缩放。后台管理系统不兼容手机等小屏幕，表格过于密集<br>
											<h4 style="text-align: left;color:blue;">2017年12月11日</h4>
											1、修正layui富文本编辑器带来的自定义验证问题（初始化仍然有可能失败）<br>
											2、完成公告控制层，修改留言的邮箱正则表达式<br>
											<h4 style="text-align: left;color:blue;">2017年12月12日</h4>
											1、完成服务器的路径配置<br>
											2、优化手机样式<br>
											<h4 style="text-align: left;color:blue;">2017年12月13日</h4>
											1、修复关于作者缩略图失效问题，通过绑定tab的切换事件（bug:刷新会复原）<br>
											2、完善手机显示样式（bug:无法随机取出map的元素）<br>
											3、添加留言板的流加载（懒加载）<br>
											<h4 style="text-align: left;color:blue;">2017年12月14日</h4>
											1、添加文章评论懒加载，全文检索分页修复,留言评论字体完善<br>
											2、添加相册，实现等比缩放，悬浮放大，懒加载<br>
											<h4 style="text-align: left;color:blue;">2017年12月16日</h4>
											1、添加相册的点赞功能<br>
											2、待优化----减少表单提交后的刷新<br>
											<h4 style="text-align: left;color:blue;">2017年12月17日</h4>
											1、使用RestController注解<br>
											<h4 style="text-align: left;color:blue;">2017年12月18日</h4>
											1、使用流加载导致无法打印将打印的thymeleaf模板解析html中的表达式（无法记住ip对图片状态）<br>
											2、阻止刷新增加浏览量<br>
											<h4 style="text-align: left;color:blue;">2017年12月1日</h4>
											1、bug：QQ浏览器传中文参数乱码 未修复<br>
											2、添加文章查询评论接口，修复评论与留言数量显示，添加删除审核过的评论将减小评论量，
											修复评论与留言懒加载会显示所有评论的错误<br>
											3、QQ浏览器uri乱码，添加#uris.escapePath编码解决，默认utf-8解码，不需要设置接收<br>
											<h4 style="text-align: left;color:blue;">2017年12月20日</h4>
											1、添加音乐插件，美化图册<br>
											<h4 style="text-align: left;color:blue;">2017年12月21日</h4>
											1、使用redis缓存替代使用session带来的与Shiro缓存时间的冲突<br>
											2、对主要类添加logback日志<br>
											<h4 style="text-align: left;color:blue;">2017年12月23日</h4>
											1、对iphone5 4.0寸到ipad pro9.7“关于本站”界面的适配（后改为去除字体包裹标签使用layui的自适应）<br>
											<h4 style="text-align: left;color:blue;">2017年12月27日</h4>
											1、添加druid的sql监控，注解式spring的service与dao层监控
											2、文章评论使用搜狐畅评替代
										  </div>
										<h1 style="text-align:center;">The End</h1>
									</div>
								</fieldset>
							</div>
						</div>
						<!--关于网站End-->
						<!-- 关于博主 -->
						<div class="layui-tab-item">
							<div class="aboutinfo">
								<div class="aboutinfo-figure">
									<img alt="头像" id="imageName"
										style="width: 100px;height: 100px;" />
								</div>
								<p class="aboutinfo-nickname">
									<span th:text="${application.blogger.nickName}"></span>
								</p>
								<p class="aboutinfo-introduce">
									<span th:text="${application.blogger.sign}"> </span>
								</p>
								<p class="aboutinfo-location">
									<i class="fa fa-location-arrow"></i>&nbsp;江西 - 南昌
								</p>
								<hr />
								<div class="blogerinfo-contact">
									<a style="margin-left: 20px;" target="_blank" title="QQ交流"
										th:href="@{http://wpa.qq.com/msgrd?v=3&uin=568845948&site=qq&menu=yes}"><i
										class="fa fa-qq fa-2x"></i></a> <a style="margin-left: 20px;"
										target="_blank" title="给我写信"
										th:href="@{mailto:568845948@qq.com?subject=blogQuestions}"><i
										class="fa fa-envelope fa-2x"></i></a> <a
										style="margin-left: 20px;" target="_blank" title="新浪微博"
										th:href="@{https://weibo.com/p/1005053803958567/home?from=page_100505&mod=TAB&is_all=1#place}"><i
										class="fa fa-weibo fa-2x"></i></a> <a style="margin-left: 20px;"
										target="_blank" title="码云"
										th:href="@{https://github.com/jxnu-liguobin}"><i
										class="fa fa-git fa-2x"></i></a>
								</div>
								<fieldset class="layui-elem-field layui-field-title">
									<legend>简介</legend>
									<div class="layui-field-box aboutinfo-abstract abstract-bloger">
										<p style="text-align:center;">在校生~</p>
										<h1  id="p" >个人介绍</h1>
										<p id="profile" th:utext="${application.blogger.profile}"></p>
										<h1 style="text-align:center;">The End</h1>
									</div>
									
								</fieldset>
							</div>
						</div>
						<!--关于作者End-->
						<div class="layui-tab-item">
							<div class="aboutinfo">
								<div class="aboutinfo-figure">
									<img src="../images/messagewall.png" alt="留言墙" />
								</div>
								<p class="aboutinfo-nickname">留言墙</p>
								<p class="aboutinfo-introduce">
									本页面可留言、吐槽、提问。拒绝灌水！<br> <span style="color: red;">注：访客用户名自填与多级评论暂时不实现。
									灌水请在文章下评论。</span>
								</p>
								<p class="aboutinfo-location">
									<i class="fa fa-clock-o"></i>&nbsp;<span id="time"></span>
								</p>
								<hr />
								<div class="aboutinfo-contact">
									<p style="font-size:2em;">沟通交流，拉近你我！</p>
								</div>
								<fieldset class="layui-elem-field layui-field-title">
									<legend>Leave a message</legend>
									<div class="layui-field-box">
										<div class="leavemessage" style="text-align:initial">
											<form class="layui-form blog-editor" action="">
												<div class="layui-form-item">
													<textarea name="content" lay-verify="content" id="content"
														placeholder="请输入内容" class="layui-textarea layui-hide"></textarea>
												</div>
												<div class="layui-form-item">
													<div class="" id="enableEmail">
														<input type="text" name="email" placeholder="请选择是否输入邮箱"
															autocomplete="off" class="layui-input" value=""
															lay-verify="mail" id="email">
													</div>
												</div>
												<div class="layui-form-item"  >
													<input type="text" name="code" lay-verify="required"
														placeholder="请输入验证码" autocomplete="off"
														class="layui-input" id="code" value=""> <a
														class="layui-btn layui-btn-primary "
														style="padding: 0 0 0 ;border: 0;margin-top: 16px;float: left;" data-type="refresh">
														<img id="imgObj" alt="验证码" style="margin:0 0;float: left;"
														th:src="@{/blog/redisValidateCode}" />
													</a>

												</div>
												<div class="layui-form-item " style="float: left;">
													<span  id="error" style="font-size: 12px; color: red;float: left;"></span>

												</div><hr>
												<div class="layui-form-item">
													<a  style="float: left;"class="layui-btn  layui-btn-primary layui-btn-xs"
														data-type="refresh"> 换一张</a>
													<button style="float: left;" class="layui-btn layui-btn-xs"
														lay-submit="formLeaveMessage"
														lay-filter="formLeaveMessage">提交</button>
												</div>
											</form>
										</div>

										<fieldset id="Lazy" class="layui-elem-field"
											th:if="${not #lists.isEmpty(messageList)}">
											<legend style="text-align: center;font-size: 1em" th:text="访客评论"></legend>
											<!-- <fieldset class="layui-elem-field layui-field-title"
												th:each="message,messageStat: ${messageList}" th:if="${messageStat.count lt 6}">
												<legend  style="font-size: 10px;text-align: left;"
													th:text="${messageStat.index+1}+'楼 '+${message.address}"></legend>
												<div class="layui-field-box">
													&nbsp;&nbsp;<span
														style="color: red;float:right ;font-size: 10px;"
														th:text="${message.messageDateStr}"></span>
													<div class="content" style="text-align: left;">
														<p th:utext="${message.content}"></p>
													</div>
												</div>
											</fieldset> -->
										</fieldset>
									</div>
									<!--       <div class="layui-field-box">
                                        <div class="leavemessage" style="text-align:initial">
                                            <form class="layui-form blog-editor" action="">
                                                <div class="layui-form-item">
                                                    <textarea name="editorContent" lay-verify="content" id="remarkEditor" placeholder="请输入内容" class="layui-textarea layui-hide"></textarea>
                                                </div>
                                                <div class="layui-form-item">
                                                    <button class="layui-btn" lay-submit="formLeaveMessage" lay-filter="formLeaveMessage">提交留言</button>
                                                </div>
                                            </form>
                                            <ul class="blog-comment">
                                                <li>
                                                    <div class="comment-parent">
                                                        <img src="../images/Logo_40.png" alt="不落阁" />
                                                        <div class="info">
                                                            <span class="username">不落阁</span>
                                                        </div>
                                                        <div class="content">
                                                            我为大家做了模拟留言与回复！试试吧！
                                                        </div>
                                                        <p class="info info-footer"><span class="time">2017-03-18 18:09</span><a class="btn-reply" href="javascript:;" onclick="btnReplyClick(this)">回复</a></p>
                                                    </div>
                                                    <hr />
                                                    <div class="comment-child">
                                                        <img src="../images/Absolutely.jpg" alt="Absolutely" />
                                                        <div class="info">
                                                            <span class="username">Absolutely</span><span>这是用户回复内容</span>
                                                        </div>
                                                        <p class="info"><span class="time">2017-03-18 18:26</span></p>
                                                    </div>
                                                    <div class="comment-child">
                                                        <img src="../images/Absolutely.jpg" alt="Absolutely" />
                                                        <div class="info">
                                                            <span class="username">Absolutely</span><span>这是第二个用户回复内容</span>
                                                        </div>
                                                        <p class="info"><span class="time">2017-03-18 18:26</span></p>
                                                    </div>
                                                  回复表单默认隐藏 不实现多级回复 
                                                    <div class="replycontainer layui-hide">
                                                        <form class="layui-form" action="">
                                                            <div class="layui-form-item">
                                                                <textarea name="replyContent" lay-verify="replyContent" placeholder="请输入回复内容" class="layui-textarea" style="min-height:80px;"></textarea>
                                                            </div>
                                                            <div class="layui-form-item">
                                                                <button class="layui-btn layui-btn-mini" lay-submit="formReply" lay-filter="formReply">提交</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div> -->
								</fieldset>
							</div>
						</div>
						<!--留言墙End-->
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 底部 -->
	<footer class="blog-footer">
		<p>
			<span>Copyright</span><span>&copy;</span><span>2017</span><a href="https://www.dreamylost.cn">梦境迷离</a><span>Design
				By jxnu-liguobin</span>
		</p>
		<p>
			<a href="http://www.miitbeian.gov.cn" target="_blank">赣ICP备17017283号-1</a>
		</p>
	</footer>
	<!--侧边导航-->
	<ul
		class="layui-nav layui-nav-tree layui-nav-side blog-nav-left layui-hide"
		lay-filter="nav">
		<li class="layui-nav-item"><a th:href="@{/index/home.html}"><i
				class="fa fa-home fa-fw"></i>&nbsp;网站首页</a></li>
		<li class="layui-nav-item"><a th:href="@{/index/article.html}"><i
				class="fa fa-file-text fa-fw"></i>&nbsp;文章专栏</a></li>
		<li class="layui-nav-item"><a
			th:href="@{/indexViews/resource.html}"><i
				class="fa fa-tags fa-fw"></i>&nbsp;资源分享</a></li>
		<li class="layui-nav-item"><a
			th:href="@{/indexViews/timeline.html}"><i class="fa fa-road fa-fw"></i>&nbsp;点点滴滴</a></li>
		<li class="layui-nav-item layui-this"><a th:href="@{/index/about.html}"><i
				class="fa fa-info fa-fw"></i>&nbsp;关于本站</a></li>
	</ul>
	<!--分享窗体-->
	<div class="blog-share layui-hide">
		<div class="blog-share-body">
			<div style="width: 200px;height:100%;">
				<div class="bdsharebuttonbox">
					<a class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a> <a
						class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a> <a
						class="bds_weixin" data-cmd="weixin" title="分享到微信"></a> <a
						class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
				</div>
			</div>
		</div>
	</div>
	 <!-- 音乐播放器 -->
    <div id="QPlayer">
	<ol id="playlist"></ol>
	<div id="pContent">
		<div id="player">
			<span class="cover"></span>
			<div class="ctrl">
				<div class="musicTag marquee">
					<strong>Title</strong>
					 <span> - </span>
					<span class="artist">Artist</span>
				</div>
				<div class="progress">
					<div class="timer left">0:00</div>
					<div class="contr">
						<div class="rewind icon"></div>
						<div class="playback icon"></div>
						<div class="fastforward icon"></div>
					</div>
					<div class="right">
						<div class="liebiao icon"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="ssBtn">
		        <div class="adf"></div>
	    </div>
	</div>
	</div>
    
	<!--遮罩-->
	<div class="blog-mask animated layui-hide"></div>
	<!-- layui.js -->
	<script th:src="@{/layui/layui.js}"></script>
	<!-- 全局脚本 -->
	<script th:src="@{/js/global.js}"></script>
	<script th:src="@{/js/about.js}"></script>
	<!-- 本页脚本 -->
	<script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/jquery.marquee.min.js}"></script>
	<script th:src="@{/js/player.js}"></script>
	<script th:inline="javascript" type="text/javascript">
	layui.use(['laypage', 'layer','jquery','form','element','layedit','flow'], function(){
	  var laypage = layui.laypage,layer = layui.layer,$ = layui.jquery,form=layui.form,
	  element=layui.element,layedit =layui.layedit ;
	  	//评论和留言的编辑器
		var editIndex = layedit.build('content', {
			height : 150,
			tool : ['strong','italic','link', ,'unlink','|','left', 'center', 'right', '|', 'face'],
		});
		window.onload = function(){
			var  w =$('#p').width()*1/8 ;
			if (w<100){
				w=100;
			} 
			$('img').each(function(){
				var img_w = $(this).width();// 图片宽度
				var img_h = $(this).height();// 图片高度
				if (img_w > w) {// 如果图片宽度超出指定最大宽度
					var height = (w * img_h) / img_w; // 高度等比缩放
					$(this).css({
						"width" : w,
						"height" : height
					});// 设置缩放后的宽度和高度
				} 
			})
		}
		//流加载
		var flow = layui.flow;
		flow.load({
	    elem: '#Lazy' //指定列表容器
	    ,done: function(page, next){ //到达临界点（默认滚动触发），触发下一页（也就相当于ajax中的sucess方法，回调作用）
	      var lis = [];//空数组
	      //以Ajax请求为例，请求下一页数据（注意：page是从2开始返回）
	        $.ajax({
				url:'../blog/messageLazy/list',
				dataType:'json',
				type:'post',
				data:{
					page:page,
				},
				success:function(res){
						layui.each(res.data, function(index, item){			
				      		lis.push('<fieldset class="layui-elem-field layui-field-title"><legend style="font-size: 0.8em;text-align: left;">'
				      		+((index+1)+(res.currentPage-1)*10)+'楼  '
				      		+item.address+'网友  '+
				 			'</legend><div class="layui-field-box"><span style="color:red;font-size: 0.75em;float:right;">'+item.messageDateStr
				 			+'</span><br><div class="content" style="text-align: left;"><p>'
				      		+item.content+
				      		'</p></div></div></fieldset>'); 
				   }); 
				next(lis.join(''), page < res.count);
			}
		});
	}
});
		//评论和留言的编辑器的验证
		form.verify({
			content : function(value) {
				value = $.trim(layedit.getText(editIndex));
				if (value == "")
					return "至少得有一个字吧";
				layedit.sync(editIndex);
			},mail :[
				/(^(?:\w+\.?)*\w+@(?:\w+\.)+\w+$)|(^$)/,
			'请输入正确格式的邮箱或者不输入'
			]
		});
	  //自定义样式
	  $("#imageName").attr('src','../uploads/'+[[${application.blogger.imageName}]]); //显示博主头像
	  //缩放
	  	form.on('submit(formLeaveMessage)', function(data) {
		//获取留言内容 带标记
		var content = layedit.getContent(editIndex);
		var email = $("#email").val();
		var code = $("#code").val();
		$.ajax({
			async : false,
			url : '../blog/message/save',
			data : {
				'content' : content,
				'email' : email,
				'code' : code,
			},
			type : 'post',
			success : function(result) {
					if(typeof result ==='string'){
						result = JSON.parse(result);
					}
					console.log(result)
					if (result.success) {
						layer.alert('留言成功，您的留言将在审核后显示！', {
							title : '系统提示',
							icon : 6,
							closeBtn: 0
						}, function(index) {
							layer.close(index);
							location.reload();
							//$('#LAY_layedit_1').contents().find('body').html('');
							//$('#code').val("");
							$('#email').val("");
							$('#LAY_layedit_1').contents().find('body').html('');//清空
						});
					} if (!result.success) {
							var error = result.errorInfo
							console.log(error);
							$('#error').text(error); //设置span标签的值
							return false;
					}
			}
	});
	return false;
});
//注册自定义函数
var $ = layui.$,
   active = {
       /**
	 *定义函数绑定到按钮的data-type上 delBlogType
	 */
       refresh: function() {
      	var imgSrc = $("#imgObj");  
        var src = '/blog/redisValidateCode';
        var url = src;
        var timestamp = (new Date()).valueOf();  
        var index = url.indexOf("?",url);  
        if (index > 0) {  
            url = url.substring(0, url.indexOf(url, "?"));  
        }  
        if ((url.indexOf("&") >= 0)) {  
            url = url + "×tamp=" + timestamp;  
        } else {  
            url = url + "?timestamp=" + timestamp;  
        } 
        imgSrc.attr("src", url);  
       },
      }
 $('.layui-form-item .layui-btn-primary').on('click',
    function() {
        var type = $(this).data('type');
        active[type] ? active[type].call(this) : '';
    });
 $('.layui-form-item .layui-btn-xs').on('click',
    function() {
        var type = $(this).data('type');
        active[type] ? active[type].call(this) : '';
    });
  $('.layui-form-item .close').on('click',
    function() {
        var type = $(this).data('type');
        active[type] ? active[type].call(this) : '';
    });
   form.on('switch(email)', function(data){
	  console.log(data.elem.checked); //开关是否开启，true或者false
		  $('#enableEmail input').prop('disabled', !data.elem.checked);
	});  
    
});


</script>
</body>
</html>